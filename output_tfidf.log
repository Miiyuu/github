Step 1: Processing raw data...
All files merged and saved to output/exp_3_3/total/total.csv
Grouped data saved to output/exp_3_3/total/grouped_total.csv
All files merged and saved to output/exp_3_3/total/cm_total.csv
Grouped data saved to output/exp_3_3/total/cm_grouped_total.csv
Step 2: Marker standardization...
Input sequence provided is already in string format. No operation performed
56 input query terms found dup hits:	[('TNF', 7), ('VEGFA', 5), ('LAMP3', 12), ('CD14', 2), ('CD1A', 2), ('LYVE1', 3), ('SPP1', 10), ('FO
25 input query terms found no hit:	['CD16', 'CD172A', 'MP3', 'HLA/FCER1A', 'CD68/CD163', 'CD14hiCD16-', 'CD14+CD16hi', 'CD14hiCD16+', '
查询成功率: 91.47%
Input sequence provided is already in string format. No operation performed
4 input query terms found no hit:	['CD16', 'CTIP2', 'OCT6', 'hfb_G_000352']
查询成功率: 90.91%
a1bg alpha-1-b glycoprotein
a1bg-as1 flj23569 ncrna00181 a1bgas a1bg-as a1bg antisense rna 1
a1cf acf asp acf64 acf65 apobec1cf apobec1 complementation factor

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD16"
    候选信息列表: [{'symbol': 'FCGR3A', 'alias_symbol': 'CD16 CD16a FcgammaRIIIa FcGRIIIA', 'prev_symbol': 'FCGR3 FCG3', 'name': 'Fc gamma receptor IIIa', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FCGR3B', 'alias_symbol': 'CD16 CD16b FcgammaRIIIb FcRIIIb', 'prev_symbol': 'FCGR3 FCG3', 'name': 'Fc gamma receptor IIIb', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-CO1', 'alias_symbol': 'COX1 COI', 'prev_symbol': 'MTCO1', 'name': 'mitochondrially encoded cytochrome c oxidase I', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-CO2', 'alias_symbol': 'COX2 CO2', 'prev_symbol': 'MTCO2', 'name': 'mitochondrially encoded cytochrome c oxidase II', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND6', 'alias_symbol': 'NAD6 ND6', 'prev_symbol': 'MTND6', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 6', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"CD16"在候选信息列表中有两个匹配项，分别是"FCGR3A"和"FCGR3B"。这两个基因符号都在其'alias_symbol'字段中包含了"CD16"。根据常用的基因命名规范以及"CD16"的广泛使用情况，这两个基因符号都可以作为标准化结果。然而，"FCGR3A"通常被认为是更常见的与"CD16"相关联的基因符号，因此选择"FCGR3A"作为修正结果。
修正结果: FCGR3A
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD172A"
    候选信息列表: [{'symbol': 'SIRPA', 'alias_symbol': 'SHPS1 SIRP MYD-1 BIT P84 SHPS-1 SIRPalpha CD172a SIRPalpha2 MFR SIRP-ALPHA-1', 'prev_symbol': 'PTPNS1', 'name': 'signal regulatory protein alpha', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP1', 'alias_symbol': '', 'prev_symbol': 'MTHSP1', 'name': 'mitochondrially encoded major H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息中，第一个条目{'symbol': 'SIRPA', ...}的'alias_symbol'字段包含'CD172a'，这与原始标记"CD172A"非常匹配（仅大小写不同）。因此，选择该条目的'symbol'作为标准化结果。
修正结果: SIRPA
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "MP3"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"MP3"与候选信息中的任何条目均无明显匹配。候选信息中未出现与"MP3"相关的符号、别名或名称，因此无法找到合适的标准化结果。
修正结果: MP3
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "HLA/FCER1A"
    候选信息列表: [{'symbol': 'HLA-DOA', 'alias_symbol': 'HLA-D0-alpha', 'prev_symbol': 'HLA-DZA HLA-DNA', 'name': 'major histocompatibility complex, class II, DO alpha', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FCER1A', 'alias_symbol': 'FcepsilonRIalpha FCERIA', 'prev_symbol': 'FCE1A', 'name': 'Fc epsilon receptor Ia', 'alias_name': '', 'prev_name': ''}, {'symbol': 'HLA-F-AS1', 'alias_symbol': '', 'prev_symbol': '', 'name': 'HLA-F antisense RNA 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'HLA-DRB9', 'alias_symbol': 'D6S206 D6S206E', 'prev_symbol': 'HLA-DRB1L HLA-DR1BL', 'name': 'major histocompatibility complex, class II, DR beta 9 (pseudogene)', 'alias_name': '', 'prev_name': ''}, {'symbol': 'HLA-J', 'alias_symbol': 'CDA12 HLA-59', 'prev_symbol': 'HLA-CDA12 D6S203', 'name': 'major histocompatibility complex, class I, J (pseudogene)', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"HLA/FCER1A"看起来像是两个基因符号的组合，其中"FCER1A"在候选信息中直接匹配到了一个条目，而"HLA"部分没有明确指向某个特定基因。因此，选择与"FCER1A"完全匹配的候选信息中的'symbol'作为标准化结果。
修正结果: FCER1A
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD68/CD163"
    候选信息列表: [{'symbol': 'CD163', 'alias_symbol': 'M130 MM130 SCARI1', 'prev_symbol': '', 'name': 'CD163 molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CD68', 'alias_symbol': 'SCARD1 GP110 DKFZp686M18236 LAMP4', 'prev_symbol': '', 'name': 'CD68 molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CD163L1', 'alias_symbol': 'M160 CD163B SCARI2 WC1', 'prev_symbol': '', 'name': 'CD163 molecule like 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-LIPCAR', 'alias_symbol': 'uc022bqs.1 LIPCAR', 'prev_symbol': '', 'name': 'mitochondrially encoded long non-coding cardiac associated RNA', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"CD68/CD163"包含了两个基因符号的部分组合，分别是"CD68"和"CD163"。在候选信息列表中，可以找到与这两个部分完全匹配的条目，分别是{'symbol': 'CD68'}和{'symbol': 'CD163'}。由于原始标记是两个基因符号的组合形式，修正结果应选择与其最匹配的标准化基因符号组合。
修正结果: CD68/CD163
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD14hiCD16-"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"CD14hiCD16-"描述的是一种免疫细胞亚群的表型，与候选信息中的基因符号及其别名均无明显关联。候选信息列表中的基因主要涉及线粒体编码和脂肪酸代谢相关基因，未找到与"CD14"或"CD16"相关的基因符号或名称。因此无法匹配到合适的标准化结果。
修正结果: CD14hiCD16-
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD14+CD16hi"
    候选信息列表: [{'symbol': 'CD14', 'alias_symbol': '', 'prev_symbol': '', 'name': 'CD14 molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-OLR', 'alias_symbol': 'OriL', 'prev_symbol': 'MTOLR', 'name': 'mitochondrially encoded light strand origin of replication', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND6', 'alias_symbol': 'NAD6 ND6', 'prev_symbol': 'MTND6', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 6', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，没有找到与原始标记"CD14+CD16hi"完全匹配或相关的标准化基因符号。虽然有一个候选信息的symbol为"CD14"，但它仅表示CD14部分，无法覆盖整个原始标记的含义（包括CD16hi部分）。因此，无法选择任何一个候选信息作为标准化结果。
修正结果: CD14+CD16hi
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD14hiCD16+"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"CD14hiCD16+"描述了一种免疫细胞亚群，通常与单核细胞或巨噬细胞的表型相关。然而，在候选信息列表中，所有条目均为线粒体基因（MT-ND4、MT-ND4L、MT-ND5等）或脂肪酸代谢相关基因（FADS2），与免疫细胞标记无直接关联。因此，无法找到与原始标记匹配的候选信息。
修正结果: CD14hiCD16+
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "PD-L1"
    候选信息列表: [{'symbol': 'CD274', 'alias_symbol': 'B7-H B7H1 PD-L1 PDL1 B7-H1', 'prev_symbol': 'PDCD1LG1', 'name': 'CD274 molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'UCHL1', 'alias_symbol': 'PGP9.5 Uch-L1 UCHL-1', 'prev_symbol': 'PARK5', 'name': 'ubiquitin C-terminal hydrolase L1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'APOL1', 'alias_symbol': '', 'prev_symbol': 'APOL', 'name': 'apolipoprotein L1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'L1CAM', 'alias_symbol': 'CD171 NCAM-L1 CAML1', 'prev_symbol': 'HSAS1 SPG1 HSAS MASA MIC5 S10', 'name': 'L1 cell adhesion molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'ENPP2', 'alias_symbol': 'ATX PD-IALPHA', 'prev_symbol': 'PDNP2', 'name': 'ectonucleotide pyrophosphatase/phosphodiesterase 2', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个候选信息的alias_symbol字段包含"PD-L1"，这与原始标记完全匹配。因此，选择该候选信息的symbol字段值"CD274"作为标准化结果。
修正结果: CD274
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "TRL3"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，未找到与原始标记"TRL3"相关的任何匹配信息。候选信息中的'symbol'、'alias_symbol'、'prev_symbol'等字段均未包含"TRL3"或其可能的变体。因此无法进行标准化，返回原始标记名称。
修正结果: TRL3
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD207 langerin "
    候选信息列表: [{'symbol': 'CD207', 'alias_symbol': 'Langerin CLEC4K', 'prev_symbol': '', 'name': 'CD207 molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-LIPCAR', 'alias_symbol': 'uc022bqs.1 LIPCAR', 'prev_symbol': '', 'name': 'mitochondrially encoded long non-coding cardiac associated RNA', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个条目包含'symbol'为'CD207'，并且其'alias_symbol'包含'Langerin'，这与原始标记"CD207 langerin"完全匹配。其他候选信息与原始标记无关。
修正结果: CD207
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "not"
    候选信息列表: [{'symbol': 'CNOT4P1', 'alias_symbol': '', 'prev_symbol': '', 'name': 'CCR4-NOT transcription complex subunit 4 pseudogene 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CNOT7P1', 'alias_symbol': '', 'prev_symbol': '', 'name': 'CCR4-NOT transcription complex subunit 7 pseudogene 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CNOT7P2', 'alias_symbol': '', 'prev_symbol': '', 'name': 'CCR4-NOT transcription complex subunit 7 pseudogene 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CNOT7', 'alias_symbol': '', 'prev_symbol': 'CAF1', 'name': 'CCR4-NOT transcription complex subunit 7', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CNOT10', 'alias_symbol': 'FLJ12890 FLJ13165', 'prev_symbol': '', 'name': 'CCR4-NOT transcription complex subunit 10', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"not"是一个非常模糊的词，无法直接与候选信息中的基因符号或名称明确对应。经过检查候选信息列表，所有条目均属于CCR4-NOT转录复合体相关基因，但没有一个条目的symbol、alias_symbol、prev_symbol、name、alias_name或prev_name能够直接匹配"not"。因此无法确定最佳匹配项。
修正结果: not
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "EPCAM"
    候选信息列表: [{'symbol': 'EPCAM-DT', 'alias_symbol': '', 'prev_symbol': '', 'name': 'EPCAM divergent transcript', 'alias_name': '', 'prev_name': ''}, {'symbol': 'EPCAM', 'alias_symbol': 'Ly74 TROP1 GA733-2 EGP34 EGP40 EGP-2 KSA CD326 Ep-CAM HEA125 KS1/4 MK-1 MH99 MOC31 MOC-31 323/A3 17-1A TACST-1 CO-17A ESA BerEp4 Ber-Ep4', 'prev_symbol': 'M4S1 MIC18 TACSTD1', 'name': 'epithelial cell adhesion molecule', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第二个条目明确包含原始标记"EPCAM"作为其'symbol'字段，并且其别名（alias_symbol）和之前符号（prev_symbol）也与该基因相关。因此，这个候选信息最匹配原始标记。
修正结果: EPCAM
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD8"
    候选信息列表: [{'symbol': 'CD8A', 'alias_symbol': 'p32 CD8alpha', 'prev_symbol': 'CD8', 'name': 'CD8 subunit alpha', 'alias_name': '', 'prev_name': ''}, {'symbol': 'CD8B', 'alias_symbol': 'Ly-3 LYT3 P37 CD8beta', 'prev_symbol': 'CD8B1', 'name': 'CD8 subunit beta', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ATT', 'alias_symbol': '', 'prev_symbol': 'MTATT', 'name': 'mitochondrially encoded membrane attachment site', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-CO1', 'alias_symbol': 'COX1 COI', 'prev_symbol': 'MTCO1', 'name': 'mitochondrially encoded cytochrome c oxidase I', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个条目 {'symbol': 'CD8A', 'alias_symbol': 'p32 CD8alpha', 'prev_symbol': 'CD8', ...} 的 'prev_symbol' 字段明确标注了 'CD8'，这表明该条目的标准化符号 'CD8A' 是原始标记 'CD8' 的更新版本。因此，选择该条目的 'symbol' 作为标准化结果。
修正结果: CD8A
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "DC_LAMP"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，没有找到与"DC_LAMP"相关的任何匹配信息（包括symbol、alias_symbol、prev_symbol、name等字段）。因此无法将原始标记标准化为候选信息中的任何结果。
修正结果: DC_LAMP
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "KI67"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，没有找到与原始标记"KI67"匹配的'symbol'、'alias_symbol'或'prev_symbol'。因此无法将"KI67"标准化为候选信息中的任何结果。
修正结果: KI67
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "NKX2.1"
    候选信息列表: [{'symbol': 'NKX2-1-AS1', 'alias_symbol': '', 'prev_symbol': '', 'name': 'NKX2-1 antisense RNA 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NKX2-2-AS1', 'alias_symbol': 'NKX2-2AS', 'prev_symbol': '', 'name': 'NKX2-2 antisense RNA 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NKX2-8', 'alias_symbol': 'NKX2.8 Nkx2-9', 'prev_symbol': 'NKX2H', 'name': 'NK2 homeobox 8', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NKX2-1', 'alias_symbol': 'TTF-1 TTF1', 'prev_symbol': 'NKX2A BCH TITF1', 'name': 'NK2 homeobox 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NKX2-2', 'alias_symbol': 'NKX2.2', 'prev_symbol': 'NKX2B', 'name': 'NK2 homeobox 2', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第4个候选信息的'symbol'为'NKX2-1'，并且其'alias_symbol'包含'TTF-1 TTF1'，'prev_symbol'包含'NKX2A BCH TITF1'，这些都与原始标记'NKX2.1'高度相关。此外，'NKX2-1'是已知的标准化基因符号，符合修正要求。
修正结果: NKX2-1
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "COUP-TFII NR2F2 "
    候选信息列表: [{'symbol': 'NR2F2', 'alias_symbol': 'COUP-TFII COUPTFB SVP40 NF-E3 COUPTF2', 'prev_symbol': 'ARP1 TFCOUP2', 'name': 'nuclear receptor subfamily 2 group F member 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NR2F2-AS1', 'alias_symbol': '', 'prev_symbol': '', 'name': 'NR2F2 antisense RNA 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'GTF2I', 'alias_symbol': 'TFII-I BAP-135 SPIN BTKAP1 DIWS IB291', 'prev_symbol': 'WBSCR6', 'name': 'general transcription factor IIi', 'alias_name': '', 'prev_name': ''}, {'symbol': 'NR2F1', 'alias_symbol': 'EAR-3 COUP-TFI TCFCOUP1 SVP44 COUPTF1', 'prev_symbol': 'ERBAL3 TFCOUP1', 'name': 'nuclear receptor subfamily 2 group F member 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"COUP-TFII NR2F2"中包含"COUP-TFII"和"NR2F2"，其中"COUP-TFII"出现在第一个候选信息的'alias_symbol'字段中，且该候选信息的'symbol'为"NR2F2"，完全匹配原始标记的内容。其他候选信息与原始标记无直接关联。
修正结果: NR2F2
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "OCT6 POU3F1 "
    候选信息列表: [{'symbol': 'POU3F1', 'alias_symbol': 'OCT6 SCIP', 'prev_symbol': 'OTF6', 'name': 'POU class 3 homeobox 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HPR', 'alias_symbol': 'HPR', 'prev_symbol': 'MTHPR', 'name': 'mitochondrially encoded replication primer', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND3', 'alias_symbol': 'ND3 NAD3', 'prev_symbol': 'MTND3', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 3', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记 "OCT6 POU3F1" 中的 "OCT6" 与候选信息中第一个条目的 'alias_symbol' 匹配，且其 'symbol' 为 "POU3F1"，与原始标记中的 "POU3F1" 完全一致。因此，该候选信息是最匹配的结果。
修正结果: POU3F1
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CTIP2"
    候选信息列表: [{'symbol': 'BCL11B', 'alias_symbol': 'CTIP-2 CTIP2 hRIT1-alpha SMARCM2', 'prev_symbol': 'ZNF856B', 'name': 'BCL11 transcription factor B', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个条目{'symbol': 'BCL11B', 'alias_symbol': 'CTIP-2 CTIP2 hRIT1-alpha SMARCM2'}的别名（alias_symbol）字段明确包含了原始标记"CTIP2"，因此可以确定该条目与原始标记最匹配。根据规则，应选择其'symbol'字段"BCL11B"作为标准化结果。
修正结果: BCL11B
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "OCT6"
    候选信息列表: [{'symbol': 'POU3F1', 'alias_symbol': 'OCT6 SCIP', 'prev_symbol': 'OTF6', 'name': 'POU class 3 homeobox 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HPR', 'alias_symbol': 'HPR', 'prev_symbol': 'MTHPR', 'name': 'mitochondrially encoded replication primer', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND3', 'alias_symbol': 'ND3 NAD3', 'prev_symbol': 'MTND3', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 3', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个条目'symbol'为'POU3F1'，其'alias_symbol'包含'OCT6'，这表明'OCT6'是'POU3F1'的别名。因此，可以确定原始标记'OCT6'的标准化结果为'POU3F1'。
修正结果: POU3F1
```

All markers processed. Results saved to: output/exp_3_3/marker/corrected_markers.csv
a1bg alpha-1-b glycoprotein
a1bg-as1 flj23569 ncrna00181 a1bgas a1bg-as a1bg antisense rna 1
a1cf acf asp acf64 acf65 apobec1cf apobec1 complementation factor

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CD16"
    候选信息列表: [{'symbol': 'FCGR3A', 'alias_symbol': 'CD16 CD16a FcgammaRIIIa FcGRIIIA', 'prev_symbol': 'FCGR3 FCG3', 'name': 'Fc gamma receptor IIIa', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FCGR3B', 'alias_symbol': 'CD16 CD16b FcgammaRIIIb FcRIIIb', 'prev_symbol': 'FCGR3 FCG3', 'name': 'Fc gamma receptor IIIb', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-CO1', 'alias_symbol': 'COX1 COI', 'prev_symbol': 'MTCO1', 'name': 'mitochondrially encoded cytochrome c oxidase I', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-CO2', 'alias_symbol': 'COX2 CO2', 'prev_symbol': 'MTCO2', 'name': 'mitochondrially encoded cytochrome c oxidase II', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND6', 'alias_symbol': 'NAD6 ND6', 'prev_symbol': 'MTND6', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 6', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"CD16"在候选信息中匹配到了两个可能的基因符号：FCGR3A和FCGR3B。这两个基因都包含"CD16"作为别名（alias_symbol）。然而，根据常见的基因命名规则以及CD16通常与Fc gamma受体相关的背景知识，CD16更常被用来指代FCGR3A（CD16a），这是主要表达在NK细胞和巨噬细胞上的亚型。因此，选择FCGR3A作为最匹配的结果。
修正结果: FCGR3A
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "CTIP2"
    候选信息列表: [{'symbol': 'BCL11B', 'alias_symbol': 'CTIP-2 CTIP2 hRIT1-alpha SMARCM2', 'prev_symbol': 'ZNF856B', 'name': 'BCL11 transcription factor B', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个候选信息的'symbol'为'BCL11B'，其'alias_symbol'字段包含'CTIP2'，这与原始标记完全匹配。因此，选择该候选信息的'symbol'作为标准化结果。
修正结果: BCL11B
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "OCT6"
    候选信息列表: [{'symbol': 'POU3F1', 'alias_symbol': 'OCT6 SCIP', 'prev_symbol': 'OTF6', 'name': 'POU class 3 homeobox 1', 'alias_name': '', 'prev_name': ''}, {'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HPR', 'alias_symbol': 'HPR', 'prev_symbol': 'MTHPR', 'name': 'mitochondrially encoded replication primer', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND3', 'alias_symbol': 'ND3 NAD3', 'prev_symbol': 'MTND3', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 3', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 在候选信息列表中，第一个条目包含别名 'OCT6 SCIP'，其中明确提到了原始标记 'OCT6'。因此，该条目与原始标记最匹配，其标准化符号 'POU3F1' 应作为修正结果。
修正结果: POU3F1
```

    你是一个基因标记标准化工具，需要根据候选信息修正原始标记，将其名称修正为候选信息中的标准化结果。你会得到一个候选信息列表，其中包括5个检索出的候选信息，它们的排序是随机打乱的。请在所有候选信息中，选择你认为跟marker最匹配的结果。如果能够找到，就选择候选信息中的'symbol'作为标准化结果；如果找不到，就返回原始标记名称。给出你的理由。
    请严格按照如下格式输出：
    ```
    理由: <理由>
    修正结果: <标准化的基因符号>
    ```
    
    现在请处理以下标记：
    原始标记: "hfb_G_000352"
    候选信息列表: [{'symbol': 'FADS2', 'alias_symbol': 'FADSD6 D6D TU13 DES6 SLL0262', 'prev_symbol': 'LLCDL2', 'name': 'fatty acid desaturase 2', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-HSP2', 'alias_symbol': '', 'prev_symbol': 'MTHSP2', 'name': 'mitochondrially encoded minor H-strand promoter', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND5', 'alias_symbol': 'ND5 NAD5', 'prev_symbol': 'MTND5', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 5', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4L', 'alias_symbol': 'ND4L NAD4L', 'prev_symbol': 'MTND4L', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4L', 'alias_name': '', 'prev_name': ''}, {'symbol': 'MT-ND4', 'alias_symbol': 'ND4 NAD4', 'prev_symbol': 'MTND4 LHON', 'name': 'mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 4', 'alias_name': '', 'prev_name': ''}]
    
```
理由: 原始标记"hfb_G_000352"与候选信息列表中的所有条目均无直接匹配关系。该标记既不匹配任何'symbol'、'alias_symbol'，也不匹配'prev_symbol'或其他字段。因此无法找到合适的标准化结果。
修正结果: hfb_G_000352
```

All markers processed. Results saved to: output/exp_3_3/marker/cm_corrected_markers.csv
已完成标记标准化，共修改 13 处基因符号
文件已保存至: output/exp_3_3/marker/corrected_total.csv
已完成标记标准化，共修改 3 处基因符号
文件已保存至: output/exp_3_3/marker/cm_corrected_total.csv
Step 4: Evaluation...
结果已保存到 output/exp_3_3/marker/after_result.csv

按文章分组的平均指标:
平均marker召回率: 0.7167
平均marker精确率: 0.1951
平均tissue_cell召回率: 0.3333
平均tissue_cell精确率: 0.0909

所有文章合并后的指标:
总marker召回率: 0.7045
总marker精确率: 0.1902
总tissue_cell召回率: 0.2727
总tissue_cell精确率: 0.0517

全局指标(不按文章分组):
全局marker召回率: 0.7045
全局marker精确率: 0.1902
全局tissue_cell召回率: 0.2727
全局tissue_cell精确率: 0.0517
结果已保存到 output/exp_3_3/marker/before_result.csv

按文章分组的平均指标:
平均marker召回率: 0.6833
平均marker精确率: 0.1911
平均tissue_cell召回率: 0.3333
平均tissue_cell精确率: 0.0909

所有文章合并后的指标:
总marker召回率: 0.6818
总marker精确率: 0.1840
总tissue_cell召回率: 0.2727
总tissue_cell精确率: 0.0517

全局指标(不按文章分组):
全局marker召回率: 0.6818
全局marker精确率: 0.1840
全局tissue_cell召回率: 0.2727
全局tissue_cell精确率: 0.0517
Step 4: Cell tissue standardization...
ours

===== 数据处理统计 =====
原始数据总条数: 293
human数据条数: 184
  - tissue_type缺失: 46 条
  - cell_name缺失: 4 条
去除空值后有效数据: 134 条

过滤后的数据已保存到: output/exp_3_3/cell/filter_total.csv

===== 匹配统计结果 =====
匹配条数: 0
匹配率: 0.00%

处理完成，结果已保存到: output/exp_3_3/cell/matched_tissue_cell.csv
CellMarker

===== 数据处理统计 =====
原始数据总条数: 44
human数据条数: 44
  - tissue_type缺失: 0 条
  - cell_name缺失: 0 条
去除空值后有效数据: 44 条

过滤后的数据已保存到: output/exp_3_3/cell/cm_filter_total.csv

===== 匹配统计结果 =====
匹配条数: 0
匹配率: 0.00%

处理完成，结果已保存到: output/exp_3_3/cell/cm_matched_tissue_cell.csv
Step 5: LLM-based cell_tissue standardization...
ours
处理细胞数据:   0%|          | 0/134 [00:00<?, ?it/s]处理细胞数据:  19%|        | 26/134 [00:00<00:00, 257.94it/s]处理细胞数据:  51%|    | 69/134 [00:00<00:00, 353.30it/s]处理细胞数据:  93%|| 124/134 [00:00<00:00, 439.93it/s]处理细胞数据: 100%|| 134/134 [00:00<00:00, 415.32it/s]
[]
[]
[]
[]
[]
[]
[]
[('uterus', 1.0)]
[('uterus', 1.0)]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[('kidney', 1.0)]
[('kidney', 1.0)]
[]
[]
[('lung', 1.0)]
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 1 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 2 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 3 次尝试修正 `lung cancer/macrophage` 失败，重试...
LLM调用失败，保持原始数据
[('lung', 1.0)]
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 1 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 2 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 3 次尝试修正 `lung cancer/macrophage` 失败，重试...
LLM调用失败，保持原始数据
[('lung', 1.0)]
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 1 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 2 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 3 次尝试修正 `lung cancer/macrophage` 失败，重试...
LLM调用失败，保持原始数据
[('lung', 1.0)]
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 1 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 2 次尝试修正 `lung cancer/macrophage` 失败，重试...
prompt:  
    你是一个生物医学专家，正在帮助标准化细胞和组织类型的标注。请根据以下原始数据和从标准文件中检索得到的候选匹配，给出最合适的修正结果。修正时，优先选择与原始数据最匹配的组织-细胞类型组合。如果原始细胞类型与候选匹配中的细胞类型是包含关系，或细胞之间有发育关系等，也认为其匹配。注意，如果细胞类型匹配的是free_annotation，需要用其对应的cell_ontology_class作为细胞修正的结果。如果你认为没有合适的匹配，则保持原始数据不变。

    原始数据:
    - 原始组织: lung cancer
    - 原始细胞类型: macrophage

    候选匹配:
候选组织 1: lung
  候选细胞 1: cell_ontology_class='macrophage', free_annotation='macrophage' (相似度: 0.84)
  候选细胞 2: cell_ontology_class='macrophage', free_annotation='monocyte/macrophage' (相似度: 0.69)
  候选细胞 3: cell_ontology_class='macrophage', free_annotation='tissue resident macrophage' (相似度: 0.57)
  候选细胞 4: cell_ontology_class='macrophage', free_annotation='macrophages' (相似度: 0.48)
  候选细胞 5: cell_ontology_class='macrophage', free_annotation='sorted myeloid' (相似度: 0.36)


    请严格按照如下格式输出：
    ```
    理由: <你的判断理由>
    修正组织: <修正后的组织类型>
    修正细胞: <修正后的细胞类型>
    ```
    
调用大模型出错: name 'API_KEY' is not defined
第 3 次尝试修正 `lung cancer/macrophage` 失败，重试...
LLM调用失败，保持原始数据
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]

处理完成！统计信息:
总处理条数: 134
完全修正条数(found): 0
结果已保存到: output/exp_3_3/cell/corrected_tissue_cell.csv
CellMarker
处理细胞数据:   0%|          | 0/44 [00:00<?, ?it/s]处理细胞数据: 100%|| 44/44 [00:00<00:00, 460.98it/s]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]

处理完成！统计信息:
总处理条数: 44
完全修正条数(found): 0
结果已保存到: output/exp_3_3/cell/cm_corrected_tissue_cell.csv
Step 6: correcting total.csv...
ours
filter_total.csv - 原始记录: 134条, 修正记录: 0条
corrected_total.csv - 原始记录: 293条, 修正记录: 0条
处理完成，结果已保存到指定路径
CellMarker
filter_total.csv - 原始记录: 44条, 修正记录: 0条
corrected_total.csv - 原始记录: 44条, 修正记录: 0条
处理完成，结果已保存到指定路径
'锟斤拷+淇姝ｅ' is not recognized as an internal or external command,
operable program or batch file.
结果已保存到 output/exp_3_3/cell/before_result.csv

按文章分组的平均指标:
平均marker召回率: 0.7167
平均marker精确率: 0.1951
平均tissue_cell召回率: 0.3333
平均tissue_cell精确率: 0.0909

所有文章合并后的指标:
总marker召回率: 0.7045
总marker精确率: 0.1902
总tissue_cell召回率: 0.2727
总tissue_cell精确率: 0.0517

全局指标(不按文章分组):
全局marker召回率: 0.7045
全局marker精确率: 0.1902
全局tissue_cell召回率: 0.2727
全局tissue_cell精确率: 0.0517
杩婊ゅ+淇姝ｅ
usage: 3_eval.py [-h] --cm_path CM_PATH --test_path TEST_PATH --output OUTPUT
3_eval.py: error: the following arguments are required: --cm_path, --test_path, --output
'锟斤拷+淇姝ｅ' is not recognized as an internal or external command,
operable program or batch file.
usage: 3_eval.py [-h] --cm_path CM_PATH --test_path TEST_PATH --output OUTPUT
3_eval.py: error: the following arguments are required: --cm_path, --test_path, --output
杩婊ゅ+淇姝ｅ
结果已保存到 output/exp_3_3/cell/after_filter_result.csv

按文章分组的平均指标:
平均marker召回率: 0.5167
平均marker精确率: 0.2656
平均tissue_cell召回率: 0.3333
平均tissue_cell精确率: 0.1429

所有文章合并后的指标:
总marker召回率: 0.5682
总marker精确率: 0.2841
总tissue_cell召回率: 0.2727
总tissue_cell精确率: 0.1132

全局指标(不按文章分组):
全局marker召回率: 0.5682
全局marker精确率: 0.2841
全局tissue_cell召回率: 0.2727
全局tissue_cell精确率: 0.1132
All steps completed
